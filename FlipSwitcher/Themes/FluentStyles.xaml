<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:converters="clr-namespace:FlipSwitcher.Converters">

    <!-- Converters -->
    <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    <converters:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter"/>

    <!-- Fluent 2 Typography -->
    <FontFamily x:Key="SegoeUIVariable">Segoe UI Variable, Segoe UI, sans-serif</FontFamily>
    
    <!-- Text Styles -->
    <Style x:Key="DisplayTextStyle" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{DynamicResource SegoeUIVariable}"/>
        <Setter Property="FontSize" Value="40"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
    </Style>
    
    <Style x:Key="TitleLargeTextStyle" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{DynamicResource SegoeUIVariable}"/>
        <Setter Property="FontSize" Value="28"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
    </Style>
    
    <Style x:Key="TitleTextStyle" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{DynamicResource SegoeUIVariable}"/>
        <Setter Property="FontSize" Value="20"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
    </Style>
    
    <Style x:Key="SubtitleTextStyle" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{DynamicResource SegoeUIVariable}"/>
        <Setter Property="FontSize" Value="16"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
    </Style>
    
    <Style x:Key="BodyTextStyle" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{DynamicResource SegoeUIVariable}"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
    </Style>
    
    <Style x:Key="BodyStrongTextStyle" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{DynamicResource SegoeUIVariable}"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
    </Style>
    
    <Style x:Key="CaptionTextStyle" TargetType="TextBlock">
        <Setter Property="FontFamily" Value="{DynamicResource SegoeUIVariable}"/>
        <Setter Property="FontSize" Value="12"/>
        <Setter Property="FontWeight" Value="Normal"/>
        <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
    </Style>

    <!-- Fluent 2 Search Box Style -->
    <Style x:Key="FluentSearchBoxStyle" TargetType="TextBox">
        <Setter Property="FontFamily" Value="{DynamicResource SegoeUIVariable}"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
        <Setter Property="Background" Value="{DynamicResource ControlDefaultBrush}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource SurfaceStrokeBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="CaretBrush" Value="{DynamicResource AccentDefaultBrush}"/>
        <Setter Property="SelectionBrush" Value="{DynamicResource AccentDefaultBrush}"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="TextBox">
                    <Grid>
                        <Border x:Name="Border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <Grid Margin="12,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Search Icon -->
                                <Path Grid.Column="0" 
                                      Data="M10 0C4.48 0 0 4.48 0 10C0 15.52 4.48 20 10 20C12.4 20 14.6 19.13 16.32 17.68L23.32 24.68C23.71 25.07 24.34 25.07 24.73 24.68C25.12 24.29 25.12 23.66 24.73 23.27L17.73 16.27C19.13 14.55 20 12.35 20 10C20 4.48 15.52 0 10 0ZM10 18C5.59 18 2 14.41 2 10C2 5.59 5.59 2 10 2C14.41 2 18 5.59 18 10C18 14.41 14.41 18 10 18Z"
                                      Fill="{StaticResource TextSecondaryBrush}"
                                      Stretch="Uniform"
                                      Width="16" Height="16"
                                      Margin="0,0,10,0"
                                      VerticalAlignment="Center"/>
                                
                                <!-- Text Content and Placeholder Container -->
                                <Grid Grid.Column="1" VerticalAlignment="Center">
                                    <!-- Text Content -->
                                    <ScrollViewer x:Name="PART_ContentHost" 
                                                  VerticalAlignment="Center"
                                                  HorizontalAlignment="Stretch"/>
                                    
                                    <!-- Placeholder -->
                                    <TextBlock x:Name="Placeholder"
                                               Text="{DynamicResource SearchPlaceholder}"
                                               Foreground="{StaticResource TextTertiaryBrush}"
                                               VerticalAlignment="Center"
                                               IsHitTestVisible="False"
                                               Visibility="Collapsed"/>
                                </Grid>
                                
                                <!-- Clear Button -->
                                <Button x:Name="ClearButton"
                                        Grid.Column="2"
                                        Visibility="Collapsed"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Margin="8,0,0,0"
                                        Cursor="Hand"
                                        VerticalAlignment="Center">
                                    <Path Data="M12 10.586L6.707 5.293C6.317 4.903 5.683 4.903 5.293 5.293C4.903 5.683 4.903 6.317 5.293 6.707L10.586 12L5.293 17.293C4.903 17.683 4.903 18.317 5.293 18.707C5.683 19.097 6.317 19.097 6.707 18.707L12 13.414L17.293 18.707C17.683 19.097 18.317 19.097 18.707 18.707C19.097 18.317 19.097 17.683 18.707 17.293L13.414 12L18.707 6.707C19.097 6.317 19.097 5.683 18.707 5.293C18.317 4.903 17.683 4.903 17.293 5.293L12 10.586Z"
                                          Fill="{StaticResource TextSecondaryBrush}"
                                          Stretch="Uniform"
                                          Width="12" Height="12"/>
                                </Button>
                            </Grid>
                        </Border>
                        
                        <!-- Focus Indicator -->
                        <Border x:Name="FocusBorder"
                                BorderBrush="{StaticResource AccentDefaultBrush}"
                                BorderThickness="0,0,0,2"
                                CornerRadius="8"
                                Opacity="0"/>
                    </Grid>
                    
                    <ControlTemplate.Triggers>
                        <Trigger Property="Text" Value="">
                            <Setter TargetName="Placeholder" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <Trigger Property="Text" Value="{x:Null}">
                            <Setter TargetName="Placeholder" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <DataTrigger Binding="{Binding Text.Length, RelativeSource={RelativeSource Self}}" Value="0">
                            <Setter TargetName="Placeholder" Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                        <Trigger Property="IsFocused" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource ControlInputActiveBrush}"/>
                            <Setter TargetName="FocusBorder" Property="Opacity" Value="1"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource ControlSecondaryBrush}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Fluent 2 Window Item Style -->
    <Style x:Key="FluentWindowItemStyle" TargetType="ListBoxItem">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Padding" Value="12,10"/>
        <Setter Property="Margin" Value="4,2"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                    <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{StaticResource SurfaceStrokeDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="{TemplateBinding Padding}"
                            Margin="{TemplateBinding Margin}"
                            TextElement.Foreground="{StaticResource TextPrimaryBrush}">
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="Center"/>
                    </Border>
                    
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource CardBackgroundHoverBrush}"/>
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource AccentDefaultBrush}"/>
                            <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource AccentLight1Brush}"/>
                            <Setter TargetName="Border" Property="TextElement.Foreground" Value="{StaticResource TextOnAccentBrush}"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsSelected" Value="True"/>
                                <Condition Property="IsMouseOver" Value="True"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource AccentLight1Brush}"/>
                            <Setter TargetName="Border" Property="TextElement.Foreground" Value="{StaticResource TextOnAccentBrush}"/>
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Fluent 2 ScrollBar Thumb Style -->
    <Style x:Key="FluentScrollBarThumb" TargetType="Thumb">
        <Setter Property="Background" Value="{DynamicResource ScrollBarThumbDefaultBrush}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Thumb">
                    <Border x:Name="ThumbBorder"
                            Background="{TemplateBinding Background}"
                            CornerRadius="3"
                            Margin="1"/>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="ThumbBorder" Property="Background" Value="{DynamicResource ScrollBarThumbHoverBrush}"/>
                        </Trigger>
                        <Trigger Property="IsDragging" Value="True">
                            <Setter TargetName="ThumbBorder" Property="Background" Value="{DynamicResource ScrollBarThumbPressedBrush}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Fluent 2 Vertical ScrollBar Style -->
    <Style x:Key="FluentVerticalScrollBarStyle" TargetType="ScrollBar">
        <Setter Property="Width" Value="6"/>
        <Setter Property="MinWidth" Value="6"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Margin" Value="0,2,2,2"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ScrollBar">
                    <Border Background="Transparent" CornerRadius="3">
                        <Track x:Name="PART_Track" IsDirectionReversed="True">
                            <Track.Thumb>
                                <Thumb Style="{StaticResource FluentScrollBarThumb}"/>
                            </Track.Thumb>
                        </Track>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Fluent 2 Horizontal ScrollBar Style -->
    <Style x:Key="FluentHorizontalScrollBarStyle" TargetType="ScrollBar">
        <Setter Property="Height" Value="6"/>
        <Setter Property="MinHeight" Value="6"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Margin" Value="2,0,2,2"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ScrollBar">
                    <Border Background="Transparent" CornerRadius="3">
                        <Track x:Name="PART_Track" IsDirectionReversed="False">
                            <Track.Thumb>
                                <Thumb Style="{StaticResource FluentScrollBarThumb}"/>
                            </Track.Thumb>
                        </Track>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Fluent 2 ScrollViewer Style -->
    <Style x:Key="FluentScrollViewerStyle" TargetType="ScrollViewer">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ScrollViewer">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <ScrollContentPresenter Grid.Column="0" Grid.Row="0"/>
                        
                        <ScrollBar x:Name="PART_VerticalScrollBar"
                                   Grid.Column="1" Grid.Row="0"
                                   Style="{StaticResource FluentVerticalScrollBarStyle}"
                                   Orientation="Vertical"
                                   Value="{TemplateBinding VerticalOffset}"
                                   Maximum="{TemplateBinding ScrollableHeight}"
                                   ViewportSize="{TemplateBinding ViewportHeight}"
                                   Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
                        
                        <ScrollBar x:Name="PART_HorizontalScrollBar"
                                   Grid.Column="0" Grid.Row="1"
                                   Style="{StaticResource FluentHorizontalScrollBarStyle}"
                                   Orientation="Horizontal"
                                   Value="{TemplateBinding HorizontalOffset}"
                                   Maximum="{TemplateBinding ScrollableWidth}"
                                   ViewportSize="{TemplateBinding ViewportWidth}"
                                   Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    
    <!-- Default ScrollBar Style (backward compatibility) -->
    <Style x:Key="FluentScrollBarStyle" TargetType="ScrollBar" BasedOn="{StaticResource FluentVerticalScrollBarStyle}"/>

    <!-- Fluent 2 ListBox Style -->
    <Style x:Key="FluentListBoxStyle" TargetType="ListBox">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
        <Setter Property="ItemContainerStyle" Value="{StaticResource FluentWindowItemStyle}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBox">
                    <ScrollViewer Focusable="False"
                                  Padding="{TemplateBinding Padding}"
                                  Style="{StaticResource FluentScrollViewerStyle}">
                        <ItemsPresenter/>
                    </ScrollViewer>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Fluent 2 Button Style -->
    <Style x:Key="FluentButtonStyle" TargetType="Button">
        <Setter Property="FontFamily" Value="{DynamicResource SegoeUIVariable}"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
        <Setter Property="Background" Value="{DynamicResource ControlDefaultBrush}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource SurfaceStrokeBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="16,8"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="6"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                    
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource ControlSecondaryBrush}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource ControlTertiaryBrush}"/>
                            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Fluent 2 Accent Button Style -->
    <Style x:Key="FluentAccentButtonStyle" TargetType="Button" BasedOn="{StaticResource FluentButtonStyle}">
        <Setter Property="Foreground" Value="{DynamicResource TextOnAccentBrush}"/>
        <Setter Property="Background" Value="{DynamicResource AccentDefaultBrush}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource AccentLight1Brush}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="6"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                    
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource AccentLight1Brush}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource AccentDark1Brush}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Fluent 2 Close Button Style -->
    <Style x:Key="FluentCloseButtonStyle" TargetType="Button">
        <Setter Property="Width" Value="32"/>
        <Setter Property="Height" Value="32"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            CornerRadius="6"
                            Width="{TemplateBinding Width}"
                            Height="{TemplateBinding Height}">
                        <Path x:Name="Icon"
                              Data="M18 6L6 18M6 6L18 18"
                              Stroke="{StaticResource TextSecondaryBrush}"
                              StrokeThickness="2"
                              Width="12" Height="12"
                              Stretch="Uniform"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"/>
                    </Border>
                    
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource ControlSecondaryBrush}"/>
                            <Setter TargetName="Icon" Property="Stroke" Value="{StaticResource TextPrimaryBrush}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource ControlTertiaryBrush}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Fluent 2 ComboBox Style -->
    <Style x:Key="FluentComboBoxStyle" TargetType="ComboBox">
        <Setter Property="FontFamily" Value="{DynamicResource SegoeUIVariable}"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
        <Setter Property="Background" Value="{DynamicResource ControlDefaultBrush}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource SurfaceStrokeBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="12,8"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ComboBox">
                    <Grid>
                        <ToggleButton x:Name="ToggleButton"
                                      Focusable="False"
                                      IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                      ClickMode="Press">
                            <ToggleButton.Template>
                                <ControlTemplate TargetType="ToggleButton">
                                    <Border x:Name="Border"
                                            Background="{StaticResource ControlDefaultBrush}"
                                            BorderBrush="{StaticResource SurfaceStrokeBrush}"
                                            BorderThickness="1"
                                            CornerRadius="6">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="32"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <ContentPresenter Grid.Column="0"
                                                              Content="{TemplateBinding Content}"
                                                              ContentTemplate="{TemplateBinding ContentTemplate}"
                                                              Margin="12,8"
                                                              VerticalAlignment="Center"
                                                              HorizontalAlignment="Left"/>
                                            
                                            <Path Grid.Column="1"
                                                  Data="M4 8L12 16L20 8"
                                                  Stroke="{StaticResource TextSecondaryBrush}"
                                                  StrokeThickness="2"
                                                  Width="10" Height="6"
                                                  Stretch="Uniform"
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"/>
                                        </Grid>
                                    </Border>
                                    
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Border" Property="Background" Value="{StaticResource ControlSecondaryBrush}"/>
                                        </Trigger>
                                        <Trigger Property="IsChecked" Value="True">
                                            <Setter TargetName="Border" Property="Background" Value="{StaticResource ControlTertiaryBrush}"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </ToggleButton.Template>
                        </ToggleButton>
                        
                        <ContentPresenter x:Name="ContentSite"
                                          IsHitTestVisible="False"
                                          Content="{TemplateBinding SelectionBoxItem}"
                                          ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                          Margin="12,8,32,8"
                                          VerticalAlignment="Center"
                                          HorizontalAlignment="Left"/>
                        
                        <Popup x:Name="Popup"
                               Placement="Bottom"
                               IsOpen="{TemplateBinding IsDropDownOpen}"
                               AllowsTransparency="True"
                               Focusable="False"
                               PopupAnimation="Slide">
                            <Border x:Name="DropDown"
                                    Background="{StaticResource BackgroundSolidBaseBrush}"
                                    BorderBrush="{StaticResource SurfaceStrokeBrush}"
                                    BorderThickness="1"
                                    CornerRadius="8"
                                    MinWidth="{TemplateBinding ActualWidth}"
                                    MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                    Margin="0,4,0,0">
                                <ScrollViewer Margin="4"
                                              Style="{StaticResource FluentScrollViewerStyle}">
                                    <StackPanel IsItemsHost="True"/>
                                </ScrollViewer>
                            </Border>
                        </Popup>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Fluent 2 ComboBoxItem Style -->
    <Style x:Key="FluentComboBoxItemStyle" TargetType="ComboBoxItem">
        <Setter Property="FontFamily" Value="{DynamicResource SegoeUIVariable}"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Padding" Value="12,8"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ComboBoxItem">
                    <Border x:Name="Border"
                            Background="{TemplateBinding Background}"
                            CornerRadius="4"
                            Padding="{TemplateBinding Padding}"
                            Margin="0,1">
                        <ContentPresenter VerticalAlignment="Center"/>
                    </Border>
                    
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource ControlSecondaryBrush}"/>
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource AccentDefaultBrush}"/>
                            <Setter Property="Foreground" Value="{StaticResource TextOnAccentBrush}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Fluent 2 CheckBox Style -->
    <Style x:Key="FluentCheckBoxStyle" TargetType="CheckBox">
        <Setter Property="Background" Value="{DynamicResource ControlDefaultBrush}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource ControlStrongDefaultBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="CheckBox">
                    <Border x:Name="Border"
                            Width="20" Height="20"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="4">
                        <Path x:Name="CheckMark"
                              Data="M4 10L8 14L16 6"
                              Stroke="{StaticResource TextOnAccentBrush}"
                              StrokeThickness="2"
                              Width="12" Height="10"
                              Stretch="Uniform"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              Visibility="Collapsed"/>
                    </Border>
                    
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource ControlSecondaryBrush}"/>
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource AccentDefaultBrush}"/>
                            <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource AccentDefaultBrush}"/>
                            <Setter TargetName="CheckMark" Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsChecked" Value="True"/>
                                <Condition Property="IsMouseOver" Value="True"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource AccentLight1Brush}"/>
                            <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource AccentLight1Brush}"/>
                        </MultiTrigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="Border" Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>
